import React, { useEffect, useState } from 'react'
import { Card, CardBody, CardHeader, Col, Row, Spinner } from 'reactstrap'
import ReactDatePicker from 'react-datepicker'
import { collection, getDocs, orderBy, query } from 'firebase/firestore'
import { db } from '../config/firebase-config'
import { calculateTotalExperience } from '../utils/experienceUtils'

const Profile = ({profile, isLoading }) => {

  const [totalExperience, setTotalExperience] = useState(0);

  useEffect(() => {
    getTotalExperience()
  }, []);

function getTotalExperience() {
  const experienceCollectionRef = collection(db, 'experience');
    
    getDocs(query(experienceCollectionRef, orderBy('createdAt', 'desc')))
    .then(response => {
        const getExp = response.docs.map(doc => ({
            data: doc.data(),
            id: doc.id
        }));

        const calculatedTotalExperience = calculateTotalExperience(getExp);
        setTotalExperience(calculatedTotalExperience);
    })
    .catch(error => console.log(error.message));
}


  
  return (
    <div className='section section-profile'>
      <Card>
        <CardHeader>
          <h5>Personal informations</h5>
        </CardHeader>
        <CardBody>
          {!isLoading ?
          <div className='text-center'>
            <Spinner color='primary'/>
          </div> :
          (profile.length === 0 ?
          <div className='text-center'>
            There is nothing added yet !!
          </div> :
          profile.map((prof, id)=> (
          <Row key={prof.id}>
            <Col lg="6">
              <div className="d-flex form-group">
                <div className='svg-icon me-3'>
                <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24">
                  <path fill='currentColor' d="M23.953,4.856c0,4.778,0,9.556,0,14.334c-0.037,0.005-0.046,0.032-0.057,0.062c-0.455,1.243-1.112,1.704-2.432,1.704    c-6.325,0-12.65,0-18.975,0c-0.093,0-0.187,0.002-0.28-0.002c-1.004-0.042-1.79-0.653-2.079-1.611    c-0.016-0.054-0.005-0.129-0.083-0.152c0-4.794,0-9.587,0-14.381c0.037-0.005,0.046-0.032,0.057-0.063    C0.55,3.515,1.223,3.044,2.536,3.044c6.324,0,12.648,0,18.972,0c0.086,0,0.171-0.002,0.257,0.001    c1.031,0.033,1.834,0.663,2.118,1.655C23.898,4.752,23.872,4.831,23.953,4.856z M22.552,7.31    c-0.092,0.062-0.154,0.103-0.216,0.144c-3.005,2.003-6.01,4.007-9.016,6.007c-0.894,0.595-1.759,0.586-2.651-0.009    c-3.005-2.004-6.01-4.007-9.016-6.009C1.593,7.405,1.544,7.331,1.455,7.348C1.452,7.367,1.448,7.382,1.448,7.397    c0,3.773-0.001,7.547,0.001,11.32c0,0.077,0.007,0.156,0.026,0.23c0.105,0.402,0.413,0.609,0.904,0.609c6.403,0,12.806,0,19.209,0    c0.054,0,0.109,0.002,0.163-0.001c0.472-0.024,0.799-0.355,0.8-0.828C22.553,14.937,22.552,11.148,22.552,7.31z M12.003,4.445    c-3.206,0-6.412,0-9.618-0.001c-0.206,0-0.403,0.022-0.58,0.139C1.319,4.905,1.331,5.543,1.833,5.878    c3.192,2.13,6.385,4.258,9.578,6.387c0.469,0.313,0.713,0.312,1.191-0.007c2.146-1.431,4.292-2.861,6.438-4.292    c1.047-0.698,2.096-1.395,3.142-2.094c0.347-0.232,0.463-0.576,0.307-0.928c-0.16-0.363-0.459-0.5-0.845-0.5    C18.431,4.446,15.217,4.445,12.003,4.445z"/>
                </svg>
                </div>
                <div>
                  <div className='fw-medium'>{prof.data.email}</div>
                  <div className='text-muted small'>Email Address</div>
                </div>
              </div>
            </Col>
            <Col lg="6">
              <div className="d-flex form-group">
                <div className='svg-icon me-3'>
                <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24">
                  <path fill='currentColor' d="M6.786,23.918c-0.017-0.072-0.086-0.059-0.132-0.073c-1.155-0.353-1.806-1.222-1.807-2.432    c-0.002-2.956-0.001-5.911-0.001-8.866c0-3.312,0.003-6.625-0.002-9.937c-0.001-0.846,0.302-1.539,0.98-2.055    c0.229-0.174,0.485-0.301,0.763-0.382c0.069-0.02,0.157-0.008,0.199-0.09c3.445,0,6.89,0,10.335,0    c0.205,0.098,0.435,0.116,0.64,0.222c0.941,0.484,1.394,1.256,1.393,2.307c-0.001,3.196,0,6.391,0,9.587    c0,3.064-0.003,6.127,0.002,9.191c0.001,0.836-0.293,1.526-0.961,2.04c-0.291,0.225-0.617,0.381-0.984,0.442    c-0.036,0.006-0.079-0.006-0.09,0.047C13.676,23.918,10.231,23.918,6.786,23.918z M17.959,12.024c0-3.134,0-6.269,0-9.403    c0-0.864-0.472-1.342-1.332-1.342c-3.088-0.001-6.176-0.001-9.263,0c-0.147,0-0.294,0-0.438,0.042    C6.349,1.488,6.042,1.931,6.042,2.608c0,6.261,0,12.522,0,18.783c0,0.85,0.474,1.33,1.321,1.33    c3.096,0.002,6.191,0.001,9.287-0.001c0.138,0,0.282-0.006,0.414-0.041c0.571-0.15,0.895-0.606,0.895-1.254    C17.959,18.292,17.958,15.158,17.959,12.024z"/>
                  <path fill='currentColor' d="M11.995,21.925c-0.652-0.003-1.18-0.528-1.186-1.18c-0.006-0.651,0.545-1.204,1.196-1.199    c0.645,0.004,1.181,0.54,1.186,1.187C13.197,21.387,12.655,21.928,11.995,21.925z"/>
                  <path fill='currentColor' d="M12.974,3.258c-0.372,0-0.744,0.003-1.117-0.001c-0.379-0.004-0.645-0.245-0.65-0.582c-0.005-0.347,0.262-0.6,0.653-0.602    c0.76-0.004,1.52-0.005,2.28,0c0.371,0.003,0.643,0.262,0.642,0.593c-0.001,0.332-0.273,0.586-0.645,0.59    C13.75,3.261,13.362,3.257,12.974,3.258z"/>
                  <path fill='currentColor' d="M9.822,3.255c-0.318,0.003-0.6-0.27-0.604-0.584C9.213,2.359,9.493,2.077,9.809,2.075c0.319-0.002,0.6,0.269,0.603,0.584    C10.416,2.971,10.138,3.252,9.822,3.255z"/>
                </svg>
                </div>
                <div>
                  <div className='fw-medium'>{prof.data.phoneCode} {prof.data.phone}</div>
                  <div className='text-muted small'>Office Number</div>
                </div>
              </div>
            </Col>
            <Col lg="6">
              <div className="d-flex form-group">
                <div className='svg-icon me-3'>
                <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24">
                  <path fill='currentColor' d="M0.021,21.359c0-5.615,0-11.23,0-16.845C0.098,4.48,0.068,4.405,0.082,4.35C0.44,2.851,1.646,1.895,3.188,1.893  C3.804,1.892,4.42,1.894,5.035,1.891c0.074,0,0.155,0.03,0.226-0.032c0-0.256,0.019-0.515-0.004-0.769  c-0.041-0.467,0.085-0.84,0.52-1.069c0.14,0,0.281,0,0.421,0C6.629,0.207,6.798,0.536,6.763,1C6.741,1.291,6.759,1.586,6.759,1.876  c3.508,0,6.993,0,10.482,0c0-0.274,0.019-0.532-0.004-0.787c-0.042-0.467,0.084-0.839,0.519-1.068c0.14,0,0.281,0,0.421,0  c0.431,0.186,0.6,0.515,0.565,0.979c-0.022,0.292-0.004,0.586-0.004,0.894c0.746,0,1.47-0.005,2.193,0.001  c1.351,0.012,2.529,0.909,2.92,2.208c0.046,0.152,0.043,0.317,0.128,0.458c0,5.6,0,11.199,0,16.799  c-0.086,0.055-0.061,0.153-0.08,0.229c-0.28,1.089-0.949,1.827-1.999,2.218c-0.205,0.076-0.423,0.116-0.635,0.173  c-6.208,0-12.416,0-18.624,0c-0.055-0.086-0.153-0.06-0.229-0.08c-1.162-0.305-1.915-1.035-2.278-2.175  C0.095,21.602,0.107,21.465,0.021,21.359z M22.482,8.268c-7,0-13.975,0-20.963,0c0,0.088,0,0.165,0,0.241c0,4.071,0,8.141,0,12.212  c0,1.109,0.648,1.76,1.752,1.76c5.817,0,11.635,0,17.452,0c1.109,0,1.759-0.648,1.759-1.753c0-4.071,0-8.141,0-12.212  C22.482,8.44,22.482,8.363,22.482,8.268z M17.241,3.405c-3.512,0-6.993,0-10.482,0c0,0.248,0.003,0.482-0.001,0.715  C6.75,4.557,6.429,4.886,6.012,4.887C5.596,4.888,5.27,4.558,5.263,4.123C5.259,3.884,5.262,3.645,5.262,3.396  c-0.784,0-1.547-0.027-2.308,0.008c-0.687,0.031-1.276,0.567-1.39,1.249c-0.116,0.692-0.02,1.394-0.048,2.096  c7.001,0,13.976,0,20.966,0c0-0.601,0.006-1.192-0.001-1.783c-0.011-0.803-0.595-1.498-1.397-1.554  C20.309,3.357,19.529,3.4,18.738,3.4c0,0.253,0.004,0.494-0.001,0.734c-0.01,0.432-0.342,0.76-0.759,0.754  c-0.406-0.006-0.727-0.331-0.736-0.753C17.237,3.893,17.241,3.653,17.241,3.405z"/>
                </svg>
                </div>
                <div>
                  <div className='fw-medium'>
                    <ReactDatePicker
                      selected={new Date(prof.data.dob)}
                      className='border-0 p-0 bg-white text-body fw-medium'
                      dateFormat="MMMM d, yyyy"
                      disabled
                    />
                  </div>
                  <div className='text-muted small'>Date of Birth</div>
                </div>
              </div>
            </Col>
            <Col lg="6">
              <div className="d-flex form-group">
                <div className='svg-icon me-3'>
                  <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24">
                    <path fill="currentColor" d="M12.001,5.633c0.773,0.009,1.333,0.405,1.786,0.989c0.193,0.249,0.341,0.526,0.482,0.807    c0.447,0.896,0.899,1.79,1.345,2.687c0.159,0.319,0.398,0.513,0.756,0.573c0.972,0.164,1.943,0.332,2.912,0.512    c0.353,0.066,0.681,0.213,0.983,0.412c0.864,0.572,1.177,1.564,0.792,2.525c-0.181,0.453-0.471,0.833-0.813,1.176    c-0.642,0.643-1.279,1.291-1.93,1.925c-0.32,0.312-0.412,0.661-0.311,1.093c0.222,0.95,0.475,1.894,0.636,2.858    c0.069,0.416,0.064,0.836-0.029,1.25c-0.248,1.11-1.243,1.725-2.384,1.478c-0.474-0.103-0.908-0.301-1.322-0.547    c-0.772-0.459-1.547-0.911-2.315-1.377c-0.391-0.237-0.758-0.241-1.152-0.002c-0.835,0.506-1.677,1-2.522,1.488    c-0.441,0.255-0.913,0.427-1.427,0.475c-1.119,0.103-1.984-0.6-2.14-1.72c-0.101-0.721,0.069-1.406,0.224-2.095    c0.142-0.629,0.289-1.257,0.435-1.885c0.086-0.37-0.002-0.689-0.271-0.959c-0.703-0.705-1.409-1.409-2.108-2.118    c-0.302-0.307-0.542-0.66-0.696-1.066c-0.373-0.985-0.041-1.968,0.849-2.526c0.539-0.338,1.148-0.445,1.761-0.544    c0.672-0.108,1.342-0.226,2.014-0.331c0.404-0.063,0.675-0.269,0.856-0.642c0.436-0.901,0.893-1.792,1.341-2.688    c0.252-0.505,0.554-0.97,1.013-1.315C11.131,5.792,11.536,5.628,12.001,5.633z M17.015,21.748c0.004,0,0.007-0.001,0.011-0.001    c-0.023-0.173-0.035-0.348-0.072-0.518c-0.185-0.834-0.37-1.668-0.567-2.499c-0.242-1.019-0.003-1.896,0.74-2.637    c0.687-0.685,1.375-1.368,2.051-2.064c0.204-0.21,0.446-0.459,0.34-0.774c-0.106-0.314-0.451-0.365-0.739-0.419    c-0.746-0.139-1.493-0.286-2.246-0.372c-1.217-0.139-2.071-0.72-2.574-1.854c-0.371-0.836-0.809-1.641-1.219-2.459    c-0.122-0.243-0.256-0.478-0.461-0.662C12.069,7.3,11.917,7.3,11.708,7.492c-0.196,0.18-0.324,0.409-0.441,0.644    c-0.471,0.943-0.934,1.889-1.416,2.826c-0.39,0.759-1.012,1.238-1.854,1.396c-0.823,0.155-1.652,0.279-2.477,0.42    c-0.275,0.047-0.552,0.093-0.801,0.23c-0.28,0.153-0.334,0.316-0.195,0.604c0.107,0.223,0.27,0.406,0.444,0.579    c0.668,0.667,1.345,1.324,1.999,2.005c0.613,0.638,0.862,1.413,0.69,2.285c-0.161,0.821-0.369,1.632-0.553,2.449    c-0.08,0.358-0.168,0.717-0.109,1.088c0.042,0.265,0.135,0.325,0.397,0.276c0.287-0.054,0.547-0.175,0.796-0.322    c0.818-0.484,1.63-0.977,2.454-1.451c0.896-0.515,1.809-0.534,2.71-0.016c0.771,0.443,1.53,0.906,2.295,1.359    c0.24,0.142,0.482,0.279,0.751,0.363c0.482,0.15,0.604,0.067,0.617-0.429C17.016,21.783,17.015,21.765,17.015,21.748z"/>
                    <path fill="currentColor" d="M6.137,4.773c0,1.276,0.001,2.551,0,3.827c0,0.53-0.349,0.917-0.829,0.922    C4.817,9.526,4.459,9.137,4.459,8.593c-0.001-2.551-0.001-5.102,0-7.654c0-0.539,0.339-0.911,0.829-0.913    c0.508-0.002,0.848,0.365,0.849,0.92C6.137,2.222,6.137,3.498,6.137,4.773z"/>
                    <path fill="currentColor" d="M17.883,4.75c0-1.267-0.001-2.534,0-3.801c0-0.556,0.339-0.925,0.846-0.923    c0.491,0.002,0.832,0.372,0.832,0.91c0.001,2.551,0.001,5.102,0,7.654c0,0.546-0.355,0.934-0.846,0.931    c-0.489-0.004-0.831-0.392-0.832-0.945C17.882,7.301,17.883,6.025,17.883,4.75z"/>
                    <path fill="currentColor" d="M12.849,1.971c0,0.367,0.004,0.734-0.001,1.1c-0.007,0.49-0.367,0.846-0.845,0.844    c-0.462-0.002-0.826-0.357-0.83-0.831c-0.007-0.742-0.007-1.485,0-2.227c0.004-0.474,0.368-0.829,0.831-0.83    c0.478-0.001,0.837,0.354,0.844,0.844C12.853,1.237,12.849,1.604,12.849,1.971z"/>
                  </svg>
                </div>
                <div>
                  <div className='fw-medium'>{totalExperience.years}+ Years</div>
                  <div className='text-muted small'>Total Experience</div>
                </div>
              </div>
            </Col>
            <Col>
              <div className="d-flex">
                <div className='svg-icon me-3'>
                <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24">
                  <path fill='currentColor' d="M12.682,0.09c0.213,0.091,0.445,0.08,0.668,0.121c2.988,0.554,5.138,2.224,6.33,4.995    c1.116,2.594,0.899,5.176-0.545,7.613c-2.108,3.558-4.247,7.099-6.368,10.649c-0.124,0.207-0.294,0.342-0.504,0.443    c-0.124,0-0.248,0-0.372,0c-0.283-0.152-0.44-0.415-0.602-0.677c-2.106-3.399-4.211-6.798-6.326-10.192    C3.92,11.369,3.454,9.559,3.659,7.596c0.183-1.749,0.86-3.294,2.017-4.623C6.681,1.82,7.912,1.006,9.358,0.516    c0.573-0.195,1.165-0.307,1.765-0.381c0.042-0.005,0.096,0.017,0.116-0.045C11.72,0.09,12.201,0.09,12.682,0.09z M12.106,21.848    c1.966-3.286,3.934-6.57,5.897-9.858c0.577-0.967,0.906-2.021,0.949-3.144c0.086-2.218-0.672-4.11-2.339-5.585    c-1.799-1.593-3.912-2.13-6.246-1.577C7.43,2.377,5.352,4.784,5.038,7.767c-0.172,1.631,0.233,3.127,1.097,4.514    c1.943,3.119,3.877,6.244,5.816,9.366C11.994,21.716,12.02,21.802,12.106,21.848z"/>
                  <path fill='currentColor' d="M11.982,12.651c-2.308-0.002-4.18-1.873-4.185-4.181c-0.005-2.307,1.895-4.203,4.201-4.192    c2.303,0.011,4.179,1.897,4.173,4.197C16.165,10.783,14.289,12.653,11.982,12.651z M11.974,11.26    c1.545,0.005,2.796-1.235,2.803-2.78c0.007-1.542-1.236-2.802-2.774-2.812c-1.55-0.01-2.814,1.245-2.815,2.794    C9.187,10.007,10.43,11.254,11.974,11.26z"/>
                </svg>
                </div>
                <div>
                  <div className='fw-medium'>{prof.data.country}</div>
                  <div className='text-muted small'>Location</div>
                </div>
              </div>
            </Col>
            <Col>
              <div className="d-flex">
                <div className='svg-icon me-3'>
                <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24">
                  <path fill="currentColor" d="M24.058,8.935c-0.161,0.224-0.222,0.493-0.32,0.744c-1.344,3.463-2.682,6.928-4.021,10.392    c-0.186,0.48-0.326,0.577-0.843,0.577c-4.583,0-9.166,0-13.749,0c-0.514,0-0.659-0.101-0.843-0.577    c-1.408-3.639-2.815-7.278-4.225-10.916c-0.03-0.076-0.031-0.171-0.115-0.22c0-0.126,0-0.251,0-0.377    c0.331-0.519,0.656-0.569,1.151-0.179c1.984,1.562,3.969,3.124,5.954,4.685c0.055,0.043,0.112,0.082,0.181,0.132    c0.449-1.013,0.891-2.014,1.335-3.015c0.941-2.124,1.884-4.247,2.818-6.374c0.124-0.282,0.305-0.455,0.615-0.456    c0.31-0.001,0.496,0.166,0.621,0.449c1.342,3.041,2.69,6.08,4.037,9.119c0.022,0.05,0.044,0.1,0.067,0.151    c0.088-0.011,0.137-0.076,0.196-0.122c2.014-1.536,4.027-3.073,6.041-4.609c0.47-0.359,0.859-0.264,1.1,0.265    C24.058,8.715,24.058,8.825,24.058,8.935z M12.001,5.445c-1.277,2.884-2.528,5.712-3.781,8.542    c1.217,0.956,2.416,1.898,3.618,2.842c1.306-0.997,2.595-1.98,3.889-2.969C14.489,11.065,13.256,8.281,12.001,5.445z     M19.063,18.366c1.01-2.61,1.998-5.162,2.985-7.714c-0.239,0.111-0.43,0.255-0.621,0.4c-1.339,1.021-2.679,2.043-4.018,3.065    c-0.082,0.062-0.188,0.101-0.119,0.255C17.878,15.684,18.457,16.999,19.063,18.366z M1.987,10.742    c0.977,2.523,1.956,5.049,2.942,7.596c0.167-0.292,1.711-3.796,1.758-3.982C5.835,13.573,2.148,10.745,1.987,10.742z     M18.188,19.423c-0.66-1.489-1.304-2.944-1.953-4.41c-1.147,0.876-2.271,1.734-3.403,2.599c0.747,0.588,1.468,1.155,2.188,1.723    c0.07,0.055,0.138,0.09,0.232,0.09C16.217,19.421,17.182,19.423,18.188,19.423z M10.83,17.596    c-1.055-0.829-2.08-1.635-3.122-2.453c-0.636,1.436-1.258,2.841-1.893,4.275c0.487,0,0.939,0.001,1.392,0    c0.408-0.001,0.848,0.092,1.215-0.033c0.374-0.127,0.676-0.467,1.007-0.717C9.89,18.318,10.348,17.965,10.83,17.596z     M13.128,19.404c-0.458-0.36-0.874-0.687-1.301-1.023c-0.437,0.333-0.868,0.662-1.341,1.023    C11.382,19.404,12.222,19.404,13.128,19.404z"/>
                </svg>
                </div>
                <div>
                  <div className='fw-medium'>{prof.data.freelance}</div>
                  <div className='text-muted small'>Freelance</div>
                </div>
              </div>
            </Col>
          </Row>
          ))
          )}
        </CardBody>
      </Card>
    </div>
  )
}

export default Profile